<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mirror-Bot | Interactive Digital Twin Demo</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&family=Roboto+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        :root {
            --bg: #010409;
            --sidebar: #0d1117;
            --primary: #00e5ff;
            --secondary: #7000ff;
            --accent: #ff007a;
            --success: #00ff88;
            --warning: #ffd000;
            --error: #ff3333;
            --text: #e6edf3;
            --text-dim: #8b949e;
            --border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 320px;
            background: var(--sidebar);
            border-right: 1px solid var(--border);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
            z-index: 100;
        }

        .logo h1 {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            font-size: 1.5rem;
        }

        .logo span {
            font-size: 0.75rem;
            color: var(--text-dim);
            letter-spacing: 1px;
        }

        .health-overview {
            text-align: center;
            background: rgba(255, 255, 255, 0.02);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .traffic-light {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 1rem auto;
            filter: blur(5px);
            transition: all 0.5s;
        }

        .green {
            background: var(--success);
            box-shadow: 0 0 20px var(--success);
        }

        .yellow {
            background: var(--warning);
            box-shadow: 0 0 20px var(--warning);
        }

        .red {
            background: var(--error);
            box-shadow: 0 0 20px var(--error);
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.02);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            border: 1px solid var(--border);
        }

        .stat-card .label {
            font-size: 0.7rem;
            color: var(--text-dim);
            display: block;
        }

        .stat-card .value {
            font-family: 'Roboto Mono', monospace;
            font-size: 1.25rem;
            color: var(--primary);
        }

        .oee-panel {
            margin-top: auto;
        }

        .oee-gauge {
            font-size: 2rem;
            font-family: 'Orbitron', sans-serif;
            color: var(--success);
            margin: 0.5rem 0;
        }

        .viewport-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .viewport-header {
            background: rgba(13, 17, 23, 0.8);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            z-index: 10;
        }

        .viewport-header h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
        }

        #three-container {
            flex: 1;
            background: #000;
        }

        .alert-console {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 400px;
            height: 200px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--border);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            z-index: 10;
        }

        .console-header {
            background: var(--border);
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            color: var(--primary);
            text-transform: uppercase;
        }

        #console-logs {
            padding: 1rem;
            flex: 1;
            overflow-y: auto;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.8rem;
        }

        .log-entry {
            margin-bottom: 0.5rem;
        }

        .critical {
            color: var(--error);
            font-weight: bold;
        }

        .warning {
            color: var(--warning);
        }

        .system {
            color: var(--text-dim);
        }

        .viewport-controls {
            display: flex;
            gap: 1rem;
        }

        button {
            background: var(--border);
            border: 1px solid var(--border);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
        }

        button:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .warning-btn {
            background: rgba(255, 51, 51, 0.1);
            border-color: var(--error);
        }

        .warning-btn:hover {
            background: var(--error);
            color: black;
        }

        .highlight {
            color: var(--success);
            font-weight: 700;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="logo">
                <h1>Mirror-Bot</h1>
                <span>Digital Twin AI v2.0</span>
            </div>

            <div class="health-overview">
                <h3>Asset Health</h3>
                <div id="traffic-light" class="traffic-light green"></div>
                <p id="health-label">SYSTEM HEALTHY</p>
            </div>

            <nav class="stats">
                <div class="stat-card">
                    <span class="label">VIBRATION</span>
                    <span id="vibration-val" class="value">2.50</span>
                    <span class="unit">mm/s</span>
                </div>
                <div class="stat-card">
                    <span class="label">TEMPERATURE</span>
                    <span id="temp-val" class="value">45.0</span>
                    <span class="unit">°C</span>
                </div>
                <div class="stat-card">
                    <span class="label">PRESSURE</span>
                    <span id="pressure-val" class="value">6.01</span>
                    <span class="unit">bar</span>
                </div>
            </nav>

            <div class="oee-panel">
                <h3>Live OEE</h3>
                <div class="oee-gauge">
                    <span id="oee-val">94.2%</span>
                </div>
                <p>Efficiency Gain: <span class="highlight">+30% target</span></p>
            </div>
        </aside>

        <main class="viewport-container">
            <header class="viewport-header">
                <h2>3D Digital Replica & Predictive Engine</h2>
                <div class="viewport-controls">
                    <button id="collision-toggle">Collision Safety: ACTIVE</button>
                    <button id="anomaly-button" class="warning-btn">SIMULATE ANOMALY</button>
                </div>
            </header>

            <div id="three-container"></div>

            <div id="alert-console" class="alert-console">
                <div class="console-header">AI Notification Console</div>
                <div id="console-logs">
                    <div class="log-entry system">[SYSTEM]: Industrial Digital Twin established.</div>
                    <div class="log-entry system">[SYSTEM]: IoT Streams synchronized at 1Hz.</div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- 3D SCENE SETUP ---
        const container = document.getElementById('three-container');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });

        renderer.setSize(container.clientWidth, container.clientHeight);
        container.appendChild(renderer.domElement);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0x404040, 2);
        const blueLight = new THREE.PointLight(0x00f2ff, 1, 50);
        blueLight.position.set(5, 5, 5);
        const purpleLight = new THREE.PointLight(0x7000ff, 1, 50);
        purpleLight.position.set(-5, 0, 2);
        scene.add(ambientLight, blueLight, purpleLight);

        // Grid helper for industrial feel
        const grid = new THREE.GridHelper(20, 20, 0x444444, 0x222222);
        grid.position.y = -2;
        scene.add(grid);

        // Cobot Representation (Multi-joint prototype)
        const cobotGroup = new THREE.Group();

        // Base
        const base = new THREE.Mesh(
            new THREE.CylinderGeometry(1.2, 1.2, 0.4, 32),
            new THREE.MeshPhongMaterial({ color: 0x1a1a1a })
        );
        cobotGroup.add(base);

        // Joint 1
        const j1 = new THREE.Mesh(
            new THREE.CylinderGeometry(0.8, 0.8, 1, 32),
            new THREE.MeshPhongMaterial({ color: 0x333333 })
        );
        j1.position.y = 0.5;
        base.add(j1);

        // Arm 1
        const arm1 = new THREE.Mesh(
            new THREE.BoxGeometry(0.5, 3, 0.5),
            new THREE.MeshPhongMaterial({ color: 0x7000ff, emissive: 0x200040 })
        );
        arm1.position.y = 1.5;
        j1.add(arm1);

        // Joint 2 (Elbow)
        const elbow = new THREE.Mesh(
            new THREE.SphereGeometry(0.4, 32, 32),
            new THREE.MeshPhongMaterial({ color: 0x00e5ff })
        );
        elbow.position.y = 1.5;
        arm1.add(elbow);

        // Arm 2
        const arm2 = new THREE.Mesh(
            new THREE.BoxGeometry(0.4, 2, 0.4),
            new THREE.MeshPhongMaterial({ color: 0x7000ff })
        );
        arm2.position.y = 1;
        elbow.add(arm2);

        scene.add(cobotGroup);
        camera.position.set(5, 5, 10);
        camera.lookAt(0, 1, 0);

        // --- MOCK ENGINE LOGIC ---
        let anomalyActive = false;
        const stats = {
            vibration: 2.5,
            temp: 45.0,
            pressure: 6.0
        };

        function updateSimulation() {
            // Update sensor data
            if (anomalyActive) {
                stats.vibration += Math.random() * 0.5;
                stats.temp += Math.random() * 0.8;
                stats.pressure += Math.random() * 0.1;
            } else {
                stats.vibration = 2.5 + (Math.random() - 0.5) * 0.2;
                stats.temp = 45.0 + (Math.random() - 0.5) * 0.4;
                stats.pressure = 6.0 + (Math.random() - 0.5) * 0.05;
            }

            // Update UI
            document.getElementById('vibration-val').innerText = stats.vibration.toFixed(2);
            document.getElementById('temp-val').innerText = stats.temp.toFixed(1);
            document.getElementById('pressure-val').innerText = stats.pressure.toFixed(2);

            // Health AI Logic
            const trafficLight = document.getElementById('traffic-light');
            const healthLabel = document.getElementById('health-label');
            const oeeVal = document.getElementById('oee-val');

            if (stats.vibration > 6.0 || stats.temp > 70.0) {
                trafficLight.className = "traffic-light red";
                healthLabel.innerText = "IMMINENT FAILURE";
                oeeVal.innerText = "42.5%";
                oeeVal.style.color = "var(--error)";
                if (Math.random() > 0.8) logToConsole("[CRITICAL]: Rodamiento Eje Principal con vibración crítica. Fallo en < 2h", "critical");
            } else if (stats.vibration > 4.0 || stats.temp > 55.0) {
                trafficLight.className = "traffic-light yellow";
                healthLabel.innerText = "MAINTENANCE REQUIRED";
                oeeVal.innerText = "78.1%";
                oeeVal.style.color = "var(--warning)";
                if (Math.random() > 0.95) logToConsole("[WARNING]: Recalentamiento en Motor J2 detectado.", "warning");
            } else {
                trafficLight.className = "traffic-light green";
                healthLabel.innerText = "SYSTEM HEALTHY";
                oeeVal.innerText = "96.8%";
                oeeVal.style.color = "var(--success)";
            }

            // Animation logic
            elbow.rotation.x = Math.sin(Date.now() * 0.001) * 0.5;
            j1.rotation.y += 0.01;
        }

        function logToConsole(msg, cls) {
            const logs = document.getElementById('console-logs');
            const div = document.createElement('div');
            div.className = "log-entry " + cls;
            div.innerText = `[${new Date().toLocaleTimeString()}]: ${msg}`;
            logs.prepend(div);
            if (logs.children.length > 15) logs.lastChild.remove();
        }

        // Animation Loop
        function animate() {
            requestAnimationFrame(animate);
            updateSimulation();
            renderer.render(scene, camera);
        }
        animate();

        // Listeners
        document.getElementById('anomaly-button').onclick = () => {
            anomalyActive = !anomalyActive;
            const btn = document.getElementById('anomaly-button');
            btn.innerText = anomalyActive ? "RESOLVE ANOMALY" : "SIMULATE ANOMALY";
            if (anomalyActive) logToConsole("Anomaly injection started. Monitoring patterns...", "warning");
            else logToConsole("System reset. Parameters normalizing.", "system");
        };

        window.addEventListener('resize', () => {
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        });
    </script>
</body>

</html>